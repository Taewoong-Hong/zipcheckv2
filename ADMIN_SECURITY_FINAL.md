# ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ë³´ì•ˆ ì„¤ì • ê°€ì´ë“œ (ìµœì¢…)

## ğŸ”’ ë³´ì•ˆ ì•„í‚¤í…ì²˜

### 4ê³„ì¸µ ë°©ì–´ ì²´ê³„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 1: Google OAuth SSO                               â”‚
â”‚ - Google Workspace ê³„ì •ë§Œ í—ˆìš©                          â”‚
â”‚ - ê°œì¸ Gmail ì°¨ë‹¨                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 2: ë„ë©”ì¸ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸                             â”‚
â”‚ - @zipcheck.kr ë„ë©”ì¸ë§Œ í—ˆìš©                            â”‚
â”‚ - ì½”ë“œ ë ˆë²¨ì—ì„œ ì´ì¤‘ ê²€ì¦                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 3: MFA ê°•ì œ (Google 2ë‹¨ê³„ ì¸ì¦)                   â”‚
â”‚ - Google Workspace ì •ì±…ìœ¼ë¡œ ê°•ì œ í™œì„±í™”                 â”‚
â”‚ - ë³´ì•ˆí‚¤/TOTP/SMS ì¤‘ ì„ íƒ                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 4: Supabase role = 'admin'                        â”‚
â”‚ - DB ë ˆë²¨ ê¶Œí•œ ê²€ì¦                                      â”‚
â”‚ - RLSë¡œ ë°ì´í„° ì ‘ê·¼ ì œì–´                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ ì™œ SSO (Google) > ì´ë©”ì¼/ë¹„ë²ˆ?

### âœ… SSO(Google OAuth)ì˜ ì¥ì 

1. **í”¼ì‹±Â·ì¬ì‚¬ìš© ë¹„ë²ˆ ë¦¬ìŠ¤í¬ ì œê±°**
   - âŒ ì´ë©”ì¼/ë¹„ë²ˆ: ì‚¬ìš©ìê°€ ì•½í•œ ë¹„ë²ˆ ì„¤ì •, ì¬ì‚¬ìš©, ìœ ì¶œ ê°€ëŠ¥
   - âœ… Google SSO: ì¡°ì§ ì •ì±…(2ë‹¨ê³„, ë³´ì•ˆí‚¤, ìœ„í—˜ ë¡œê·¸ì¸ ì°¨ë‹¨)ìœ¼ë¡œ í†µì œ

2. **MFA ê°•ì œ ê°€ëŠ¥**
   - âŒ ì´ë©”ì¼/ë¹„ë²ˆ: ì‚¬ìš©ìê°€ MFAë¥¼ ë„ê±°ë‚˜ ìš°íšŒ ê°€ëŠ¥
   - âœ… Google Workspace: ì¡°ì§ ê´€ë¦¬ìê°€ ì „ì› MFA/ë³´ì•ˆí‚¤ ê°•ì œ ì„¤ì •

3. **íšŒê³„ê°ì‚¬Â·ì ‘ê·¼ ê±°ë²„ë„ŒìŠ¤**
   - âœ… SSOëŠ” ë¡œê·¸ì¸ ë¡œê·¸, ì¥ì¹˜Â·ìœ„ì¹˜ ì •ì±…, ì„¸ì…˜ ê´€ë¦¬ê°€ ì²´ê³„ì 
   - Google Admin Consoleì—ì„œ ëª¨ë“  ë¡œê·¸ì¸ ì´ë ¥ ì¶”ì  ê°€ëŠ¥

4. **ìš´ì˜ ë¹„ìš© ì ˆê°**
   - âŒ ì´ë©”ì¼/ë¹„ë²ˆ: ë¹„ë²ˆ ì´ˆê¸°í™”, ë¶„ì‹¤ ì²˜ë¦¬, ì•½í•œ ë¹„ë²ˆ íƒì§€, ë¸Œë£¨íŠ¸í¬ìŠ¤ ë°©ì–´ í•„ìš”
   - âœ… Google SSO: Googleì´ ëª¨ë“  ì¸ì¦ ë³´ì•ˆ ì²˜ë¦¬

### ğŸ“Œ ê²°ë¡ 

- **ê´€ë¦¬ì í˜ì´ì§€**: Google OAuth SSOë¡œ ì ê¸ˆ (ë„ë©”ì¸ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ + MFA ê°•ì œ)
- **ì¼ë°˜ ì‚¬ìš©ì**: ì´ë©”ì¼/ë¹„ë²ˆ + ì†Œì…œ(Google, Naver, Kakao) ë³‘í–‰ í—ˆìš©

---

## ğŸš€ êµ¬í˜„ ì™„ë£Œ ì‚¬í•­

### âœ… í”„ë¡ íŠ¸ì—”ë“œ (app/zc-ops-nx7k2/page.tsx)

```typescript
// ë³´ì•ˆ ê³„ì¸µ ê²€ì¦
const ALLOWED_DOMAINS = ['zipcheck.kr'];

async function checkAuthSession() {
  // 1. Google OAuth ê²€ì¦
  if (providerId !== 'google') {
    setAuthError('Google OAuth SSO ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
    await supabase.auth.signOut();
    return;
  }

  // 2. ë„ë©”ì¸ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê²€ì¦
  if (!isEmailDomainAllowed(email)) {
    setAuthError('í—ˆìš©ëœ ë„ë©”ì¸(@zipcheck.kr)ì´ ì•„ë‹™ë‹ˆë‹¤.');
    await supabase.auth.signOut();
    return;
  }

  // 3. MFA ê²€ì¦ (Google 2ë‹¨ê³„ ì¸ì¦)
  const mfaEnabled = userMetadata?.email_verified &&
                     session.user.aud === 'authenticated' &&
                     userMetadata?.iss === 'https://accounts.google.com';
  if (!mfaEnabled) {
    setAuthError('Google ê³„ì •ì—ì„œ 2ë‹¨ê³„ ì¸ì¦ì„ í™œì„±í™”í•´ì£¼ì„¸ìš”.');
    return;
  }

  // 4. ê´€ë¦¬ì role ê²€ì¦
  const { data: userData } = await supabase
    .from('users')
    .select('role')
    .eq('id', session.user.id)
    .single();

  if (userData?.role !== 'admin') {
    setAuthError('ê´€ë¦¬ì ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.');
    return;
  }
}
```

### âœ… ë¡œê·¸ì¸ UI

- **ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸ í‘œì‹œ**: 4ë‹¨ê³„ ê²€ì¦ ìƒíƒœ ì‹¤ì‹œê°„ í‘œì‹œ
- **Google ë¡œê·¸ì¸ ë²„íŠ¼**: ê³µì‹ Google ë¸Œëœë”©
- **ì—ëŸ¬ ë©”ì‹œì§€**: êµ¬ì²´ì ì¸ ì‹¤íŒ¨ ì´ìœ  í‘œì‹œ
- **ë³´ì•ˆ ì•ˆë‚´**: ë„ë©”ì¸ ë° MFA ìš”êµ¬ì‚¬í•­ ëª…ì‹œ

---

## ğŸ“‹ ì„¤ì • ë‹¨ê³„

### 1ë‹¨ê³„: Google Workspace ì„¤ì •

#### 1-1. 2ë‹¨ê³„ ì¸ì¦ ê°•ì œ í™œì„±í™”

1. **Google Admin Console** ì ‘ì† (admin.google.com)
2. **ë³´ì•ˆ â†’ ì¸ì¦ â†’ 2ë‹¨ê³„ ì¸ì¦** ì´ë™
3. **ì¡°ì§ ë‹¨ìœ„ ì„ íƒ** (ì „ì²´ ë˜ëŠ” ê´€ë¦¬ì ê·¸ë£¹)
4. **ì‚¬ìš©ìê°€ 2ë‹¨ê³„ ì¸ì¦ì„ ì‚¬ìš© ì„¤ì •í•  ìˆ˜ ìˆë„ë¡ í—ˆìš©** â†’ **ì„¤ì •**
5. **ì‹œí–‰** ì˜µì…˜:
   - **í—ˆìš©** (ê¶Œì¥í•˜ì§€ë§Œ ì‚¬ìš©ìê°€ ëŒ ìˆ˜ ìˆìŒ)
   - **í•„ìˆ˜** âœ… (ê°•ì œ, ê¶Œì¥)
   - **ìƒˆ ì‚¬ìš©ìì— ëŒ€í•´ í•„ìˆ˜** (ì‹ ê·œ ê°€ì…ìë§Œ)

#### 1-2. ë³´ì•ˆí‚¤ ë˜ëŠ” TOTP ì„¤ì • (ì„ íƒì‚¬í•­)

- **ë³´ì•ˆ â†’ ê³ ê¸‰ ì„¤ì • â†’ ë³´ì•ˆí‚¤ í—ˆìš©** ì²´í¬
- FIDO2 í•˜ë“œì›¨ì–´ í‚¤ ë˜ëŠ” Google Authenticator ì‚¬ìš©

#### 1-3. ìœ„í—˜í•œ ë¡œê·¸ì¸ ì°¨ë‹¨

- **ë³´ì•ˆ â†’ ê³ ê¸‰ ì„¤ì • â†’ ìœ„í—˜í•œ ì´ë²¤íŠ¸**
- ìƒˆ ê¸°ê¸°, ìƒˆ ìœ„ì¹˜, ë¹„ì •ìƒ ë¡œê·¸ì¸ ì°¨ë‹¨ ì •ì±… ì„¤ì •

---

### 2ë‹¨ê³„: Supabase ì„¤ì •

#### 2-1. Google OAuth Provider ì„¤ì •

1. **Supabase Dashboard â†’ Authentication â†’ Providers â†’ Google**
2. **Enable Google Provider** í™œì„±í™”
3. **Client ID / Client Secret** ì…ë ¥ (Google Cloud Consoleì—ì„œ ë°œê¸‰)
4. **Authorized Redirect URLs** í™•ì¸:
   ```
   https://gsiismzchtgdklvdvggu.supabase.co/auth/v1/callback
   ```

#### 2-2. users í…Œì´ë¸”ì— role ì»¬ëŸ¼ ì¶”ê°€

```sql
-- Supabase SQL Editorì—ì„œ ì‹¤í–‰

-- role ì»¬ëŸ¼ ì¶”ê°€
ALTER TABLE public.users
ADD COLUMN IF NOT EXISTS role TEXT DEFAULT 'user' CHECK (role IN ('user', 'admin'));

-- ì¸ë±ìŠ¤ ìƒì„±
CREATE INDEX IF NOT EXISTS idx_users_role ON public.users(role);

-- ê´€ë¦¬ì ê¶Œí•œ ë¶€ì—¬
UPDATE public.users
SET role = 'admin'
WHERE email = 'admin@zipcheck.kr';

-- í™•ì¸
SELECT id, email, role FROM public.users WHERE role = 'admin';
```

#### 2-3. RLS ì •ì±… ì„¤ì • (ì„ íƒì‚¬í•­)

```sql
-- ê´€ë¦¬ìë§Œ ëª¨ë“  ì‚¬ìš©ì ì¡°íšŒ ê°€ëŠ¥
CREATE POLICY "Admins can read all users"
ON public.users
FOR SELECT
USING (
  auth.uid() IN (
    SELECT id FROM public.users WHERE role = 'admin'
  )
);

-- ê´€ë¦¬ì ì „ìš© í…Œì´ë¸” ìƒì„± (ê°ì‚¬ ë¡œê·¸)
CREATE TABLE IF NOT EXISTS public.admin_logs (
  id BIGSERIAL PRIMARY KEY,
  user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,
  action TEXT NOT NULL,
  details JSONB,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- RLS í™œì„±í™”
ALTER TABLE public.admin_logs ENABLE ROW LEVEL SECURITY;

-- ê´€ë¦¬ìë§Œ ì ‘ê·¼
CREATE POLICY "Admins only"
ON public.admin_logs
FOR ALL
USING (auth.uid() IN (SELECT id FROM public.users WHERE role = 'admin'))
WITH CHECK (auth.uid() IN (SELECT id FROM public.users WHERE role = 'admin'));
```

---

### 3ë‹¨ê³„: Google Cloud Console ì„¤ì •

#### 3-1. OAuth 2.0 í´ë¼ì´ì–¸íŠ¸ ì„¤ì •

1. **Google Cloud Console** â†’ APIs & Services â†’ Credentials
2. **OAuth 2.0 Client IDs** â†’ ê¸°ì¡´ í´ë¼ì´ì–¸íŠ¸ í¸ì§‘
3. **ìŠ¹ì¸ëœ JavaScript ì›ë³¸** ì¶”ê°€:
   ```
   http://localhost:3000
   https://zipcheck.kr
   ```
4. **ìŠ¹ì¸ëœ ë¦¬ë””ë ‰ì…˜ URI** ì¶”ê°€:
   ```
   http://localhost:3000/zc-ops-nx7k2
   https://zipcheck.kr/zc-ops-nx7k2
   https://gsiismzchtgdklvdvggu.supabase.co/auth/v1/callback
   ```

#### 3-2. ë„ë©”ì¸ ì œí•œ ì„¤ì • (Google Workspace)

1. **OAuth ë™ì˜ í™”ë©´** ì„¤ì •
2. **ë‚´ë¶€ ì• í”Œë¦¬ì¼€ì´ì…˜** ì„ íƒ (zipcheck.kr Workspace ì‚¬ìš©ìë§Œ í—ˆìš©)
3. ë˜ëŠ” **ì™¸ë¶€** ì„ íƒ ì‹œ ì½”ë“œì—ì„œ `hd` íŒŒë¼ë¯¸í„°ë¡œ ë„ë©”ì¸ ì œí•œ:
   ```typescript
   queryParams: {
     hd: 'zipcheck.kr', // Workspace ë„ë©”ì¸ íŒíŠ¸
   }
   ```

---

### 4ë‹¨ê³„: í™˜ê²½ë³€ìˆ˜ ì„¤ì •

```bash
# apps/web/.env.local

# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://gsiismzchtgdklvdvggu.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key_here

# Google OAuth
NEXT_PUBLIC_GOOGLE_CLIENT_ID=901515411397-soknq5qg2l3ga3ggc3gcrp70rmt2iovt.apps.googleusercontent.com

# GA4 (ì„ íƒì‚¬í•­)
GA4_PROPERTY_ID=123456789
GA_SERVICE_ACCOUNT_KEY_JSON={"type":"service_account",...}
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### âœ… ì •ìƒ ì¼€ì´ìŠ¤

1. **@zipcheck.kr ê³„ì • + MFA í™œì„±í™” + role = 'admin'**
   ```
   â†’ Google ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­
   â†’ Google ê³„ì • ì„ íƒ (admin@zipcheck.kr)
   â†’ 2ë‹¨ê³„ ì¸ì¦ (ë³´ì•ˆí‚¤/TOTP)
   â†’ 4ë‹¨ê³„ ê²€ì¦ ëª¨ë‘ í†µê³¼
   â†’ ëŒ€ì‹œë³´ë“œ í‘œì‹œ âœ…
   ```

### âŒ ì‹¤íŒ¨ ì¼€ì´ìŠ¤

1. **ê°œì¸ Gmail ê³„ì • (@gmail.com)**
   ```
   â†’ Google ë¡œê·¸ì¸ ì‹œë„
   â†’ ë„ë©”ì¸ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê²€ì¦ ì‹¤íŒ¨
   â†’ "í—ˆìš©ëœ ë„ë©”ì¸(@zipcheck.kr)ì´ ì•„ë‹™ë‹ˆë‹¤" ì—ëŸ¬
   â†’ ìë™ ë¡œê·¸ì•„ì›ƒ
   ```

2. **@zipcheck.kr ê³„ì • + MFA ë¹„í™œì„±í™”**
   ```
   â†’ Google ë¡œê·¸ì¸ ì„±ê³µ
   â†’ MFA ê²€ì¦ ì‹¤íŒ¨
   â†’ "Google ê³„ì •ì—ì„œ 2ë‹¨ê³„ ì¸ì¦ì„ í™œì„±í™”í•´ì£¼ì„¸ìš”" ì—ëŸ¬
   â†’ ìë™ ë¡œê·¸ì•„ì›ƒ
   ```

3. **@zipcheck.kr ê³„ì • + MFA í™œì„±í™” + role = 'user'**
   ```
   â†’ Google ë¡œê·¸ì¸ ì„±ê³µ
   â†’ MFA ê²€ì¦ ì„±ê³µ
   â†’ ê´€ë¦¬ì role ê²€ì¦ ì‹¤íŒ¨
   â†’ "ê´€ë¦¬ì ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤" ì—ëŸ¬
   â†’ ìë™ ë¡œê·¸ì•„ì›ƒ
   ```

---

## ğŸ›¡ï¸ ì¶”ê°€ ë³´ì•ˆ ê°•í™” (ê¶Œì¥)

### 1. Next.js Middleware ì¶”ê°€

```typescript
// apps/web/middleware.ts
import { createServerClient } from '@supabase/ssr';
import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';

const ALLOWED_DOMAINS = ['zipcheck.kr'];

export async function middleware(request: NextRequest) {
  // ê´€ë¦¬ì í˜ì´ì§€ ë³´í˜¸
  if (request.nextUrl.pathname.startsWith('/zc-ops-nx7k2')) {
    const response = NextResponse.next();
    const supabase = createServerClient(
      process.env.NEXT_PUBLIC_SUPABASE_URL!,
      process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
      { cookies: { get: (key) => request.cookies.get(key)?.value } }
    );

    const { data: { session } } = await supabase.auth.getSession();

    // 1. ë¡œê·¸ì¸ ì²´í¬
    if (!session) {
      return NextResponse.redirect(new URL('/', request.url));
    }

    // 2. Google OAuth ì²´í¬
    if (session.user.app_metadata?.provider !== 'google') {
      return NextResponse.redirect(new URL('/', request.url));
    }

    // 3. ë„ë©”ì¸ ì²´í¬
    const email = session.user.email || '';
    const domain = email.split('@')[1];
    if (!ALLOWED_DOMAINS.includes(domain)) {
      return NextResponse.redirect(new URL('/', request.url));
    }

    // 4. ê´€ë¦¬ì role ì²´í¬
    const { data: userData } = await supabase
      .from('users')
      .select('role')
      .eq('id', session.user.id)
      .single();

    if (userData?.role !== 'admin') {
      return new NextResponse('Forbidden', { status: 403 });
    }

    return response;
  }

  return NextResponse.next();
}

export const config = {
  matcher: '/zc-ops-nx7k2/:path*',
};
```

### 2. IP í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ (Cloudflare/Vercel)

```javascript
// Cloudflare WAF Rule
(ip.src ne 123.456.789.0 and http.host eq "zipcheck.kr" and http.request.uri.path contains "/zc-ops-nx7k2")
â†’ Action: Block
```

### 3. ê°ì‚¬ ë¡œê·¸ ìë™í™”

```typescript
// lib/admin-audit.ts
export async function logAdminAction(
  userId: string,
  action: string,
  details?: any
) {
  await supabase.from('admin_logs').insert({
    user_id: userId,
    action,
    details,
  });
}

// ì‚¬ìš© ì˜ˆì‹œ
await logAdminAction(session.user.id, 'VIEW_DASHBOARD', {
  ip: request.headers.get('x-forwarded-for'),
  userAgent: request.headers.get('user-agent'),
});
```

### 4. ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ë‹¨ì¶•

```typescript
// Supabase Auth ì„¤ì •
const { data, error } = await supabase.auth.signInWithOAuth({
  provider: 'google',
  options: {
    // ì„¸ì…˜ ìœ íš¨ê¸°ê°„ 8ì‹œê°„
    accessTokenLifetime: 8 * 60 * 60,
  },
});
```

---

## ğŸ“Š ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

### âœ… í•„ìˆ˜ í•­ëª©
- [x] Google OAuth SSO ì ìš©
- [x] ë„ë©”ì¸ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ (@zipcheck.kr)
- [x] MFA ê°•ì œ (Google Workspace ì •ì±…)
- [x] Supabase role = 'admin' ê²€ì¦
- [x] 4ê³„ì¸µ ê²€ì¦ UI í‘œì‹œ
- [x] ìë™ ë¡œê·¸ì•„ì›ƒ (ê²€ì¦ ì‹¤íŒ¨ ì‹œ)
- [x] ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•œ URL (/zc-ops-nx7k2)

### ğŸ”„ ê¶Œì¥ í•­ëª©
- [ ] Next.js Middleware ì¶”ê°€
- [ ] IP í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ (Cloudflare/Vercel)
- [ ] ê°ì‚¬ ë¡œê·¸ ìë™í™”
- [ ] ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ 8ì‹œê°„ ì„¤ì •
- [ ] Subdomain ë¶„ë¦¬ (admin.zipcheck.kr)
- [ ] Rate Limiting (API í˜¸ì¶œ ì œí•œ)
- [ ] ì•Œë¦¼ ì‹œìŠ¤í…œ (ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ë¡œê·¸ì¸)

---

## ğŸš¨ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### "Google OAuth SSO ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤"
**ì›ì¸**: ì´ë©”ì¼/ë¹„ë²ˆ ë˜ëŠ” ë‹¤ë¥¸ ì†Œì…œ ë¡œê·¸ì¸ìœ¼ë¡œ ì ‘ì†
**í•´ê²°**: Google ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ í•„ìš”

### "í—ˆìš©ëœ ë„ë©”ì¸ì´ ì•„ë‹™ë‹ˆë‹¤"
**ì›ì¸**: @zipcheck.kr ë„ë©”ì¸ì´ ì•„ë‹Œ ê³„ì • ì‚¬ìš©
**í•´ê²°**: Google Workspace ê³„ì • ì‚¬ìš© í•„ìš”

### "2ë‹¨ê³„ ì¸ì¦ì„ í™œì„±í™”í•´ì£¼ì„¸ìš”"
**ì›ì¸**: Google ê³„ì •ì—ì„œ MFA ë¹„í™œì„±í™”
**í•´ê²°**:
1. Google ê³„ì • â†’ ë³´ì•ˆ
2. 2ë‹¨ê³„ ì¸ì¦ â†’ ì‹œì‘í•˜ê¸°
3. íœ´ëŒ€ì „í™”/ë³´ì•ˆí‚¤/TOTP ë“±ë¡

### "ê´€ë¦¬ì ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤"
**ì›ì¸**: users í…Œì´ë¸”ì—ì„œ roleì´ 'admin'ì´ ì•„ë‹˜
**í•´ê²°**:
```sql
UPDATE public.users
SET role = 'admin'
WHERE email = 'admin@zipcheck.kr';
```

---

## ğŸ“ ìš´ì˜ ê°€ì´ë“œ

### ìƒˆ ê´€ë¦¬ì ì¶”ê°€

1. **Google Workspaceì—ì„œ ê³„ì • ìƒì„±**
   - admin.google.com â†’ ì‚¬ìš©ì â†’ ì‚¬ìš©ì ì¶”ê°€
   - ì´ë©”ì¼: `newadmin@zipcheck.kr`

2. **2ë‹¨ê³„ ì¸ì¦ ê°•ì œ ì ìš©**
   - ì¡°ì§ ì •ì±…ìœ¼ë¡œ ìë™ ì ìš©ë¨

3. **Supabaseì—ì„œ role ë¶€ì—¬**
   ```sql
   -- ë¨¼ì € í•œ ë²ˆ ë¡œê·¸ì¸í•˜ì—¬ users í…Œì´ë¸”ì— ë ˆì½”ë“œ ìƒì„±
   -- ê·¸ í›„ SQL ì‹¤í–‰
   UPDATE public.users
   SET role = 'admin'
   WHERE email = 'newadmin@zipcheck.kr';
   ```

### ê´€ë¦¬ì ê¶Œí•œ ì œê±°

```sql
-- roleì„ userë¡œ ë³€ê²½
UPDATE public.users
SET role = 'user'
WHERE email = 'oldadmin@zipcheck.kr';

-- ë˜ëŠ” Google Workspaceì—ì„œ ê³„ì • ë¹„í™œì„±í™”
```

---

**ì‘ì„±ì¼**: 2025-01-24
**ë²„ì „**: 2.0.0 (Google OAuth SSO + MFA ê°•ì œ)
**ì´ì „ ë²„ì „**: 1.0.0 (Email/Password ë°©ì‹)
