# ğŸš€ ZipCheck AI ì„œë¹„ìŠ¤ ì‹œì‘ ê°€ì´ë“œ

## ğŸ“¦ P0 ì™„ë£Œ â€” ê¸°ë³¸ ì¸í”„ë¼ êµ¬ì¶• ì™„ë£Œ!

### âœ… ì™„ë£Œëœ ì‘ì—…

1. **FastAPI ì„œë²„ ìŠ¤ìºí´ë”©**
   - ì„œë²„ ë¶€íŒ… ë° í—¬ìŠ¤ì²´í¬ ì—”ë“œí¬ì¸íŠ¸
   - CORS ë¯¸ë“¤ì›¨ì–´ ì„¤ì •
   - í™˜ê²½ ë³€ìˆ˜ ê¸°ë°˜ ì„¤ì • ì‹œìŠ¤í…œ

2. **í•µì‹¬ ëª¨ë“ˆ êµ¬í˜„**
   - LLM íŒ©í† ë¦¬ (OpenAI/Claude ì§€ì›)
   - ì„ë² ë”© ë° ë²¡í„° ê²€ìƒ‰ ì‹œìŠ¤í…œ
   - LangChain LCEL ë¶„ì„ ì²´ì¸
   - PDF íŒŒì‹± ë° ë²¡í„° ì—…ì„œíŠ¸

3. **ê°œë°œ í™˜ê²½ ì„¤ì •**
   - Docker ì´ë¯¸ì§€ ì¤€ë¹„
   - í™˜ê²½ ë³€ìˆ˜ í…œí”Œë¦¿
   - OpenAPI 3.1 ìŠ¤í™

---

## ğŸ¯ ë°”ë¡œ ì‹œì‘í•˜ê¸° (5ë¶„ ì„¤ì •)

### 1ë‹¨ê³„: ê°€ìƒí™˜ê²½ ì„¤ì •

```bash
# services/ai ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd services/ai

# ê°€ìƒí™˜ê²½ ìƒì„±
python -m venv venv

# ê°€ìƒí™˜ê²½ í™œì„±í™”
# Windows
venv\Scripts\activate
# Mac/Linux
source venv/bin/activate
```

### 2ë‹¨ê³„: ì˜ì¡´ì„± ì„¤ì¹˜

```bash
# Python íŒ¨í‚¤ì§€ ì„¤ì¹˜ (ì•½ 2-3ë¶„ ì†Œìš”)
pip install -r requirements.txt
```

### 3ë‹¨ê³„: í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

`.env` íŒŒì¼ì„ ì—´ê³  ë‹¤ìŒ í•„ìˆ˜ ê°’ì„ ì…ë ¥í•˜ì„¸ìš”:

```env
# Supabase PostgreSQL URL
DATABASE_URL=postgresql://postgres.[PROJECT_ID]:[PASSWORD]@[HOST]:5432/postgres

# OpenAI API í‚¤
OPENAI_API_KEY=sk-proj-...

# Anthropic API í‚¤
ANTHROPIC_API_KEY=sk-ant-...
```

> ğŸ’¡ **íŒ**: `.env.example` íŒŒì¼ì— ëª¨ë“  ê°€ëŠ¥í•œ í™˜ê²½ ë³€ìˆ˜ê°€ ì •ì˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

### 4ë‹¨ê³„: ì„œë²„ ì‹œì‘

```bash
# ê°œë°œ ì„œë²„ ì‹¤í–‰ (ìë™ ì¬ì‹œì‘ í™œì„±í™”)
uvicorn app:app --reload --port 8000
```

**ì„±ê³µ ë©”ì‹œì§€:**
```
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process
INFO:     Started server process
INFO:     Waiting for application startup.
INFO:     ZipCheck AI ì„œë¹„ìŠ¤ ì‹œì‘
INFO:     Application startup complete.
```

### 5ë‹¨ê³„: í…ŒìŠ¤íŠ¸

#### ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸
- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

#### ì»¤ë§¨ë“œë¼ì¸ì—ì„œ í™•ì¸
```bash
# í—¬ìŠ¤ì²´í¬
curl http://localhost:8000/healthz

# ì˜ˆìƒ ì‘ë‹µ:
# {"ok":true,"version":"2.0.0","environment":"development"}
```

---

## ğŸ—‚ï¸ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
services/ai/
â”œâ”€ ğŸ“„ app.py                    # FastAPI ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜
â”œâ”€ ğŸ“ core/                     # í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚  â”œâ”€ settings.py              # í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
â”‚  â”œâ”€ llm_factory.py           # LLM ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
â”‚  â”œâ”€ embeddings.py            # ì„ë² ë”© ëª¨ë¸
â”‚  â”œâ”€ retriever.py             # ë²¡í„° ê²€ìƒ‰
â”‚  â”œâ”€ chains.py                # ë¶„ì„ ì²´ì¸ (LCEL)
â”‚  â””â”€ dual_provider.py         # í´ë°± ë¡œì§
â”œâ”€ ğŸ“ ingest/                   # PDF ì²˜ë¦¬
â”‚  â”œâ”€ pdf_parse.py             # PDF â†’ í…ìŠ¤íŠ¸
â”‚  â””â”€ upsert_vector.py         # í…ìŠ¤íŠ¸ â†’ ë²¡í„° DB
â”œâ”€ ğŸ“ api/                      # API ìŠ¤í™
â”‚  â””â”€ openapi.yaml             # OpenAPI 3.1
â”œâ”€ ğŸ“„ requirements.txt          # Python ì˜ì¡´ì„±
â”œâ”€ ğŸ³ Dockerfile                # ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€
â”œâ”€ ğŸ“„ .env.example              # í™˜ê²½ ë³€ìˆ˜ í…œí”Œë¦¿
â””â”€ ğŸ“– README.md                 # ì˜ë¬¸ ë¬¸ì„œ
```

---

## ğŸ”§ ì£¼ìš” ì—”ë“œí¬ì¸íŠ¸

### 1. í—¬ìŠ¤ì²´í¬
```bash
GET /healthz
```
ì„œë²„ ìƒíƒœ í™•ì¸

### 2. PDF ì—…ë¡œë“œ (êµ¬í˜„ ì™„ë£Œ, í…ŒìŠ¤íŠ¸ ëŒ€ê¸°)
```bash
POST /ingest
Content-Type: multipart/form-data

{
  file: (binary),
  contract_id: "contract_001",
  addr: "ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123"
}
```

### 3. ê³„ì•½ì„œ ë¶„ì„ (êµ¬í˜„ ì™„ë£Œ, í…ŒìŠ¤íŠ¸ ëŒ€ê¸°)
```bash
POST /analyze
Content-Type: application/json

{
  "question": "ê³„ì•½ê¸ˆ ê´€ë ¨ ë¦¬ìŠ¤í¬ë¥¼ ë¶„ì„í•´ì£¼ì„¸ìš”",
  "mode": "single",
  "provider": "openai"
}
```

---

## ğŸ§ª ë‹¤ìŒ ë‹¨ê³„ í…ŒìŠ¤íŠ¸

### Supabase ì„¤ì •ì´ ì™„ë£Œë˜ë©´:

1. **pgvector í™•ì¥ í™œì„±í™”**
```sql
CREATE EXTENSION IF NOT EXISTS vector;
```

2. **ìƒ˜í”Œ PDF ì—…ë¡œë“œ í…ŒìŠ¤íŠ¸**
```bash
curl -X POST http://localhost:8000/ingest \
  -F "file=@sample_contract.pdf" \
  -F "contract_id=test_001" \
  -F "addr=ì„œìš¸ì‹œ ê°•ë‚¨êµ¬"
```

3. **ë¶„ì„ ìš”ì²­ í…ŒìŠ¤íŠ¸**
```bash
curl -X POST http://localhost:8000/analyze \
  -H "Content-Type: application/json" \
  -d '{
    "question": "ì´ ê³„ì•½ì„œì˜ ì£¼ìš” ë¦¬ìŠ¤í¬ëŠ” ë¬´ì—‡ì¸ê°€ìš”?",
    "mode": "single"
  }'
```

---

## ğŸ³ Dockerë¡œ ì‹¤í–‰í•˜ê¸°

### ì´ë¯¸ì§€ ë¹Œë“œ
```bash
docker build -t zipcheck-ai:latest .
```

### ì»¨í…Œì´ë„ˆ ì‹¤í–‰
```bash
docker run -p 8000:8000 \
  --env-file .env \
  zipcheck-ai:latest
```

---

## ğŸ“Š í˜„ì¬ êµ¬í˜„ ìƒíƒœ

| ê¸°ëŠ¥ | ìƒíƒœ | ë¹„ê³  |
|------|------|------|
| FastAPI ì„œë²„ | âœ… ì™„ë£Œ | ë¶€íŒ… ë° í—¬ìŠ¤ì²´í¬ ë™ì‘ |
| í™˜ê²½ ë³€ìˆ˜ ì‹œìŠ¤í…œ | âœ… ì™„ë£Œ | Pydantic Settings |
| OpenAPI ìŠ¤í™ | âœ… ì™„ë£Œ | `/docs`ì—ì„œ í™•ì¸ ê°€ëŠ¥ |
| PDF íŒŒì‹± | âœ… ì™„ë£Œ | unstructured + PyMuPDF |
| ë²¡í„° ì—…ì„œíŠ¸ | âœ… ì™„ë£Œ | LangChain + pgvector |
| ë‹¨ì¼ LLM ë¶„ì„ | âœ… ì™„ë£Œ | OpenAI/Claude ì§€ì› |
| ì‹¤ì œ ë™ì‘ í…ŒìŠ¤íŠ¸ | â³ ëŒ€ê¸° | Supabase ì„¤ì • í•„ìš” |
| ì»¨ì„¼ì„œìŠ¤ ëª¨ë“œ | â³ P3 | ë“€ì–¼ LLM + ì €ì§€ |
| ë¹„ë™ê¸° í | â³ P3 | Celery/RQ |

---

## ğŸš¨ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ì„œë²„ê°€ ì‹œì‘ë˜ì§€ ì•Šì•„ìš”
- `.env` íŒŒì¼ì— í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜ê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”
  - `DATABASE_URL`
  - `OPENAI_API_KEY`
  - `ANTHROPIC_API_KEY`
- Python ë²„ì „ì„ í™•ì¸í•˜ì„¸ìš” (3.11+ ê¶Œì¥)

### ì˜ì¡´ì„± ì„¤ì¹˜ê°€ ì‹¤íŒ¨í•´ìš”
```bash
# pip ì—…ê·¸ë ˆì´ë“œ
pip install --upgrade pip

# ê°œë³„ ì„¤ì¹˜ ì‹œë„
pip install fastapi uvicorn
pip install langchain langchain-openai langchain-anthropic
```

### DATABASE_URLì„ ëª¨ë¥´ê² ì–´ìš”
Supabase í”„ë¡œì íŠ¸ ì„¤ì •ì—ì„œ:
1. Settings â†’ Database
2. Connection String â†’ URI ë³µì‚¬
3. `.env`ì˜ `DATABASE_URL`ì— ë¶™ì—¬ë„£ê¸°

---

## ğŸ“š ì¶”ê°€ ë¬¸ì„œ

- [README.md](./README.md) - ì˜ë¬¸ ê¸°ìˆ  ë¬¸ì„œ
- [P0_COMPLETION.md](./P0_COMPLETION.md) - P0 ì™„ë£Œ ë³´ê³ ì„œ
- [api/openapi.yaml](./api/openapi.yaml) - OpenAPI ìŠ¤í™

---

## ğŸ¯ ë‹¤ìŒ ë§ˆì¼ìŠ¤í†¤: P1

**P1 â€” ë°ì´í„°/ë³´ì•ˆ í† ëŒ€ (Day 1~3)**

1. Supabase ìŠ¤í‚¤ë§ˆ ì„¤ê³„
   - `profiles`, `contracts`, `documents`, `embeddings`, `reports` í…Œì´ë¸”
   - pgvector ì¸ë±ìŠ¤ (IVFFlat)
   - RLS ì •ì±… ì„¤ì •

2. íŒŒì¼ ìŠ¤í† ë¦¬ì§€ ë ˆì´ì–´
   - Supabase Storage ì—°ë™
   - íŒŒì¼ ê²€ì¦ ê°•í™”

**ì‹œì‘ ì¤€ë¹„ ì™„ë£Œ!** ğŸš€
