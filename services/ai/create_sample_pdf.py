"""샘플 부동산 계약서 PDF 생성 스크립트."""
import fitz  # PyMuPDF
from pathlib import Path

def create_sample_contract_pdf(output_path: str = "sample_contract.pdf"):
    """
    테스트용 샘플 부동산 계약서 PDF 생성.

    Args:
        output_path: 저장할 PDF 파일 경로
    """
    # PDF 문서 생성
    doc = fitz.open()

    # 페이지 1 추가
    page1 = doc.new_page()

    # 계약서 내용 작성
    contract_text = """
    부동산 매매계약서

    매도인: 홍길동
    매수인: 김철수

    부동산의 표시
    - 소재지: 서울특별시 강남구 테헤란로 123
    - 지목: 대
    - 면적: 100㎡

    제1조 (매매대금)
    위 부동산의 매매대금은 금 오억원정(₩500,000,000)으로 하고,
    계약금, 중도금, 잔금으로 나누어 아래와 같이 지급한다.

    1. 계약금: 금 오천만원(₩50,000,000)은 계약 시 지급
    2. 중도금: 금 일억오천만원(₩150,000,000)은 2024년 11월 1일 지급
    3. 잔금: 금 삼억원(₩300,000,000)은 2024년 12월 31일 지급

    제2조 (소유권 이전 등)
    매도인은 잔금 수령과 동시에 매수인에게 소유권 이전등기에 필요한
    모든 서류를 교부하고 등기절차에 협력하여야 한다.

    제3조 (계약의 해제)
    매수인이 중도금(중도금이 없을 때는 잔금)을 지급하기 전까지,
    매도인은 계약금의 배액을 상환하고, 매수인은 계약금을 포기하고
    본 계약을 해제할 수 있다.

    제4조 (특약사항)
    1. 본 부동산은 현 상태 그대로 인도한다.
    2. 본 계약 체결 후 매도인의 귀책사유로 소유권 이전이 불가능할 경우,
       매도인은 계약금의 배액을 매수인에게 지급한다.
    3. 본 부동산에 근저당권, 전세권 등의 부담이 없음을 확인한다.
    4. 공과금 미납분은 매도인이 잔금일까지 완납하기로 한다.

    위 계약을 증명하기 위하여 본 계약서 2통을 작성하고,
    매도인과 매수인이 서명날인 후 각각 1통씩 보관한다.

    2024년 10월 17일

    매도인: 홍길동 (인)
    주소: 서울특별시 강남구 역삼동 456

    매수인: 김철수 (인)
    주소: 서울특별시 서초구 반포동 789

    중개인: 부동산114
    등록번호: 12345-67890
    주소: 서울특별시 강남구 테헤란로 100
    """

    # 텍스트 삽입
    page1.insert_text(
        (50, 50),  # 시작 위치
        contract_text,
        fontsize=11,
        fontname="helv",  # Helvetica font
    )

    # 페이지 2 추가 (추가 조항)
    page2 = doc.new_page()

    additional_text = """
    부동산 매매계약서 (별지)

    제5조 (위험부담)
    본 계약 체결 이후 잔금 지급 이전까지 천재지변, 화재 등으로 인한
    부동산의 멸실 또는 훼손은 매도인의 부담으로 한다.

    제6조 (권리관계)
    1. 매도인은 본 부동산에 대하여 제3자의 권리주장이 없음을 보증한다.
    2. 만약 제3자의 권리주장이 있을 경우, 매도인의 책임으로 해결한다.

    제7조 (면적 정산)
    실측 면적이 공부상 면적과 차이가 있을 경우, 평당 단가로 정산한다.
    단, 면적 차이가 ±3% 이내일 경우에는 정산하지 않기로 한다.

    제8조 (임대차 관계)
    본 부동산에는 현재 임대차 관계가 없음을 확인한다.
    만약 잔금 지급일까지 임차인이 발생할 경우,
    매도인과 매수인이 별도 협의한다.

    제9조 (중개보수)
    중개보수는 매도인과 매수인이 각각 부담하며,
    법정 중개보수율에 따라 산정한다.

    제10조 (분쟁 해결)
    본 계약과 관련된 분쟁은 매도인과 매수인의 주소지 관할 법원에서
    해결하기로 한다.

    [첨부서류]
    1. 등기부등본
    2. 토지대장
    3. 건축물대장
    4. 신분증 사본 (매도인, 매수인)

    ---

    본 계약서는 법률적 효력이 있으므로, 계약 전 충분히 검토하시기 바랍니다.
    필요시 변호사나 법무사의 자문을 받으시기를 권장합니다.
    """

    page2.insert_text(
        (50, 50),
        additional_text,
        fontsize=11,
        fontname="helv",
    )

    # PDF 저장
    output_file = Path(output_path)
    doc.save(str(output_file))
    doc.close()

    print(f"[OK] Sample PDF created: {output_file.absolute()}")
    print(f"     File size: {output_file.stat().st_size / 1024:.2f} KB")
    print(f"     Pages: 2")


if __name__ == "__main__":
    create_sample_contract_pdf("sample_contract.pdf")
