# ZipCheck AI Service

遺?숈궛 怨꾩빟??由ъ뒪??遺꾩꽍 AI ?쒕퉬??諛깆뿏??
## ?? 鍮좊Ⅸ ?쒖옉

### 1. ?섍꼍 ?ㅼ젙

```bash
# Python 媛?곹솚寃??앹꽦 (Python 3.11+ 沅뚯옣)
python -m venv venv

# 媛?곹솚寃??쒖꽦??# Windows
venv\Scripts\activate
# Linux/Mac
source venv/bin/activate

# ?섏〈???ㅼ튂
pip install -r requirements.txt
```

### 2. ?섍꼍 蹂???ㅼ젙

```bash
# .env.example??蹂듭궗?섏뿬 .env ?앹꽦
cp .env.example .env

# .env ?뚯씪???몄쭛?섏뿬 ?꾩닔 媛??낅젰
# - DATABASE_URL
# - OPENAI_API_KEY
# - ANTHROPIC_API_KEY
```

### 3. ?쒕쾭 ?ㅽ뻾

```bash
# 媛쒕컻 紐⑤뱶 (?먮룞 ?ъ떆??
uvicorn app:app --reload --port 8000

# ?먮뒗
python app.py
```

?쒕쾭媛 ?쒖옉?섎㈃ ?ㅼ쓬 URL?먯꽌 ?뺤씤:
- API: http://localhost:8000
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

### 4. ?ъ뒪泥댄겕

```bash
curl http://localhost:8000/healthz
```

?묐떟:
```json
{
  "ok": true,
  "version": "2.0.0",
  "environment": "development"
}
```

## ?뱚 ?꾨줈?앺듃 援ъ“

```
services/ai/
?쒋? app.py                    # FastAPI ?좏뵆由ъ??댁뀡 ?뷀듃由ы룷?명듃
?쒋? core/                     # ?듭떖 紐⑤뱢
?? ?쒋? settings.py           # ?섍꼍 蹂??諛??ㅼ젙
?? ?쒋? llm_factory.py        # LLM ?몄뒪?댁뒪 ?앹꽦
?? ?쒋? embeddings.py         # ?꾨쿋???ㅼ젙
?? ?쒋? retriever.py          # 踰≫꽣 寃???? ?쒋? chains.py             # LangChain LCEL 泥댁씤
?? ?붴? dual_provider.py      # ????꾨줈諛붿씠???대갚
?쒋? ingest/                   # PDF 泥섎━ 諛??몃뜳???? ?쒋? pdf_parse.py          # PDF ?뚯떛
?? ?붴? upsert_vector.py      # 踰≫꽣 DB ?낆꽌???쒋? api/                      # API ?ㅽ럺
?? ?붴? openapi.yaml          # OpenAPI 3.1 ?ㅽ럺
?쒋? requirements.txt          # Python ?섏〈???쒋? Dockerfile               # 而⑦뀒?대꼫 ?대?吏
?쒋? .env.example             # ?섍꼍 蹂???쒗뵆由??붴? README.md                # ???뚯씪
```

## ?뵎 二쇱슂 ?붾뱶?ъ씤??
### POST /ingest
怨꾩빟??PDF ?낅줈??諛?踰≫꽣 DB ???
```bash
curl -X POST http://localhost:8000/ingest \
  -F "file=@contract.pdf" \
  -F "contract_id=contract_001" \
  -F "addr=?쒖슱??媛뺣궓援??뚰뿤?濡?123"
```

### POST /analyze
怨꾩빟??遺꾩꽍 ?붿껌

```bash
curl -X POST http://localhost:8000/analyze \
  -H "Content-Type: application/json" \
  -d '{
    "question": "怨꾩빟湲?愿??由ъ뒪?щ? 遺꾩꽍?댁＜?몄슂",
    "mode": "single",
    "provider": "openai"
  }'
```

## ?맫 Docker ?ㅽ뻾

### ?대?吏 鍮뚮뱶
```bash
docker build -t zipcheck-ai:latest .
```

### 而⑦뀒?대꼫 ?ㅽ뻾
```bash
docker run -p 8000:8000 \
  --env-file .env \
  zipcheck-ai:latest
```

## ?㎦ ?뚯뒪??
### ?꾩닔 ?섍꼍 蹂??寃利?```bash
# ?쒕쾭 ?쒖옉 ???꾩닔 ???꾨씫?섎㈃ ?ㅽ뙣
# DATABASE_URL, OPENAI_API_KEY, ANTHROPIC_API_KEY ?꾩닔
```

### OpenAPI ?ㅽ럺 寃利?(schemathesis)
```bash
pip install schemathesis
schemathesis run api/openapi.yaml --base-url http://localhost:8000
```

## ?뱤 濡쒓렇 諛?紐⑤땲?곕쭅

### 濡쒓렇 ?덈꺼 ?ㅼ젙
`.env` ?뚯씪?먯꽌 `LOG_LEVEL` ?ㅼ젙:
- DEBUG: ?곸꽭 ?붾쾭源??뺣낫
- INFO: ?쇰컲 ?뺣낫 (湲곕낯媛?
- WARNING: 寃쎄퀬 硫붿떆吏
- ERROR: ?먮윭留?異쒕젰

### Sentry ?곕룞
`.env`??`SENTRY_DSN` ?ㅼ젙 ???먮룞?쇰줈 ?먮윭 ?몃옒???쒖꽦??
### Langfuse ?곕룞
LLM ?몄텧 異붿쟻???꾪빐 ?ㅼ쓬 ?섍꼍 蹂???ㅼ젙:
- LANGFUSE_PUBLIC_KEY
- LANGFUSE_SECRET_KEY
- LANGFUSE_HOST

## ?뵏 蹂댁븞 怨좊젮?ы빆

1. **?섍꼍 蹂??蹂댄샇**: `.env` ?뚯씪? ?덈? 而ㅻ컠?섏? ?딆쓬
2. **CORS ?ㅼ젙**: `AI_ALLOWED_ORIGINS`濡??덉슜??異쒖쿂留??묎렐
3. **?뚯씪 ?ш린 ?쒗븳**: PDF 理쒕? 50MB
4. **?뚯씪 ???寃利?*: PDF留??덉슜
5. **RLS (Row Level Security)**: Supabase?먯꽌 ?ъ슜?먮퀎 ?곗씠??寃⑸━

## ?벀 ?섏〈??愿由?
### 二쇱슂 ?⑦궎吏
- **FastAPI**: ???꾨젅?꾩썙??- **LangChain**: RAG ?뚯씠?꾨씪??- **OpenAI/Anthropic**: LLM ?쒓났??- **pgvector**: 踰≫꽣 寃??- **unstructured**: PDF ?뚯떛

### 踰꾩쟾 ?낅뜲?댄듃
```bash
# ?섏〈???낅뜲?댄듃
pip install --upgrade -r requirements.txt

# requirements.txt 媛깆떊
pip freeze > requirements.txt
```

## ?맀 ?몃윭釉붿뒋??
### ?쒕쾭 ?쒖옉 ?ㅽ뙣
- `.env` ?뚯씪???꾩닔 ?섍꼍 蹂???뺤씤
- DATABASE_URL???щ컮瑜?PostgreSQL ?곌껐 臾몄옄?댁씤吏 ?뺤씤
- API ?ㅺ? ?좏슚?쒖? ?뺤씤

### PDF ?뚯떛 ?ㅽ뙣
- poppler-utils ?ㅼ튂 ?뺤씤 (Linux/Mac)
- tesseract-ocr ?ㅼ튂 ?뺤씤 (OCR ?꾩슂 ??
- PDF ?뚯씪???먯긽?섏? ?딆븯?붿? ?뺤씤

### 踰≫꽣 DB ?곌껐 ?ㅽ뙣
- Supabase?먯꽌 pgvector ?뺤옣 ?쒖꽦???뺤씤:
  ```sql
  CREATE EXTENSION IF NOT EXISTS vector;
  ```
- DATABASE_URL ?뺤떇 ?뺤씤

## ?뱴 李멸퀬 臾몄꽌

- [FastAPI 臾몄꽌](https://fastapi.tiangolo.com/)
- [LangChain 臾몄꽌](https://python.langchain.com/)
- [Supabase 臾몄꽌](https://supabase.com/docs)
- [OpenAPI ?ㅽ럺](./api/openapi.yaml)

## ?뱷 媛쒕컻 濡쒕뱶留?
- ??**P0**: 遺???ㅽ럺 怨좎젙 (?꾨즺)
- ?슙 **P1**: ?곗씠??蹂댁븞 ?좊?
- ?뵜 **P2**: ?몃뜳??& ?⑥씪紐⑤뜽 遺꾩꽍
- ?뵜 **P3**: ???LLM(?대갚/而⑥꽱?쒖뒪) & ?덉젙??
## ?쩃 湲곗뿬

?댁뒋 諛?PR? ?섏쁺?⑸땲??

## ?뱞 ?쇱씠?좎뒪

MIT License



